@model Human_resource_management_System.Models.Form.ChangePassword

@{
    ViewBag.Title = "Đổi mật khẩu";
    Layout = "~/Areas/Employee/Views/Shared/_LayoutEmployee.cshtml";
    Html.EnableClientValidation(true);
    Html.EnableUnobtrusiveJavaScript(true);
}

<div class="max-w-md mx-auto bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
    <div class="px-6 py-4 border-b border-gray-50 flex items-center justify-between bg-gray-50/50">
        <h3 class="font-semibold text-gray-800 flex items-center gap-2">
            <i class="fa-solid fa-lock text-blue-500"></i>
            Đổi mật khẩu
        </h3>
    </div>

    <div class="p-6">
        @using (Html.BeginForm(null, null, FormMethod.Post, new { id = "changePasswordForm", novalidate = "novalidate" }))
        {
            @Html.AntiForgeryToken()

            if (!ViewData.ModelState.IsValid && ViewData.ModelState.ContainsKey("") && ViewData.ModelState[""].Errors.Count > 0)
            {
                <div class="mb-4 bg-red-50 border-l-4 border-red-500 p-4 rounded">
                    @Html.ValidationSummary(true, "", new { @class = "text-red-700 text-sm list-disc pl-5" })
                </div>
            }

            <div class="space-y-4">
                <div>
                    @Html.LabelFor(m => m.MatKhauHienTai, new { @class = "block text-sm font-medium text-gray-700 mb-1" })
                    <div class="relative">
                        <span class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-gray-400">
                            <i class="fa-solid fa-key"></i>
                        </span>
                        @Html.PasswordFor(m => m.MatKhauHienTai, new { @class = "pl-10 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 border", placeholder = "Nhập mật khẩu hiện tại" })
                    </div>
                    @Html.ValidationMessageFor(m => m.MatKhauHienTai, "", new { @class = "text-red-500 text-xs mt-1" })
                </div>

                <div>
                    @Html.LabelFor(m => m.MatKhauMoi, new { @class = "block text-sm font-medium text-gray-700 mb-1" })
                    <div class="relative">
                        <span class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-gray-400">
                            <i class="fa-solid fa-lock"></i>
                        </span>
                        @Html.PasswordFor(m => m.MatKhauMoi, new { @class = "pl-10 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 border", placeholder = "Nhập mật khẩu mới" })
                    </div>
                    @Html.ValidationMessageFor(m => m.MatKhauMoi, "", new { @class = "text-red-500 text-xs mt-1" })
                </div>

                <div>
                    @Html.LabelFor(m => m.XacNhanMatKhau, new { @class = "block text-sm font-medium text-gray-700 mb-1" })
                    <div class="relative">
                        <span class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-gray-400">
                            <i class="fa-solid fa-check-double"></i>
                        </span>
                        @Html.PasswordFor(m => m.XacNhanMatKhau, new { @class = "pl-10 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm py-2 px-3 border", placeholder = "Nhập lại mật khẩu mới" })
                    </div>
                    @Html.ValidationMessageFor(m => m.XacNhanMatKhau, "", new { @class = "text-red-500 text-xs mt-1" })
                </div>

                <div class="pt-4 flex gap-3">
                    <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg shadow-sm transition-colors flex items-center justify-center gap-2">
                        <i class="fa-solid fa-save"></i>
                        Lưu thay đổi
                    </button>
                    <a href="@Url.Action("Info")" class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-4 rounded-lg shadow-sm transition-colors flex items-center justify-center gap-2">
                        <i class="fa-solid fa-times"></i>
                        Hủy bỏ
                    </a>
                </div>
            </div>
        }
    </div>
</div>

<script>
    $(document).ready(function () {
        // Force validation on blur (tab out)
        var validator = $("form").data("validator");
        if (validator) {
            validator.settings.onfocusout = function (element) {
                $(element).valid();
            };
        }
    });
</script>
